{{$pageData := .}}
{{$troubleReport := $pageData.TroubleReport}}
{{$modification := $pageData.Modification}}
{{$attachments := $pageData.Attachments}}

<div class="attachments-preview-container">
    <div class="attachments-preview-label">
        <i class="bi bi-paperclip"></i>
        Anh√§nge ({{len $attachments}})
    </div>
    <div class="attachments-preview-scroll">
        {{range $attachments}}
        <div class="attachment-preview-item" 
             data-report-id="{{$troubleReport.ID}}" 
             data-attachment-id="{{.GetID}}" 
             data-is-image="{{.IsImage}}"
             onclick="viewAttachmentFromData(this.dataset.reportId, this.dataset.attachmentId, this.dataset.isImage)">
            {{if .IsImage}}
            <div class="attachment-preview-image">
                <img
                    src="./trouble-reports/attachments?id={{$troubleReport.ID}}&attachment_id={{.GetID}}"
                    alt="Attachment {{.ID}}"
                    class="preview-thumbnail"
                />
            </div>
            {{else}}
            <div class="attachment-preview-icon">
                {{if .IsDocument}}
                <i class="bi bi-file-text"></i>
                {{else if .IsArchive}}
                <i class="bi bi-file-zip"></i>
                {{else}}
                <i class="bi bi-file-earmark"></i>
                {{end}}
            </div>
            {{end}}
            <div class="attachment-preview-name">
                Attachment {{.ID}}
            </div>
            <div class="attachment-preview-type">
                {{.GetMimeType}}
            </div>
        </div>
        {{end}}
    </div>
</div>