{{if not .Submitted}}
<dialog id="dialogEdit" class="clean fullscreen" oncancel="event.preventDefault()">
    <style>
        form {
            width: 100%;
            height: 100%;
        }

        .content {
            height: 100%;
            margin: 0;
        }

        label[for="title"] {
            max-height: fit-content;
        }

        input[name="title"] {
            width: 100%;
        }

        label[for="content"] {
            height: 100%;
        }

        textarea[name="content"] {
            width: 100%;
            height: 100%;
            resize: none;
        }
    </style>

    <form
        {{if gt .ID 0}}
        hx-put="./trouble-reports/dialog-edit?id={{.ID}}"
        {{else}}
        hx-post="./trouble-reports/dialog-edit"
        {{end}}
        hx-trigger="submit"
        hx-target="#dialogEdit"
        hx-swap="outerHTML"
        class="flex column gap">
        <div class="content flex-item flex column gap">
            <label for="title" class="flex column">
                Titel
                <input
                    name="title"
                    id="title"
                    placeholder="Titel"
                    value="{{.Title}}"
                    {{if .InvalidTitle}}
                    aria-invalid="true"
                    {{end}} />
            </label>

            <!-- TODO: Anhänge einbetten ermöglichen, noch nicht implementiert -->
            <label for="content" class="flex-item flex column">
                Bericht
                <textarea
                    name="content"
                    id="content"
                    placeholder="Bericht"
                    {{if .InvalidContent}}
                    aria-invalid="true"
                    {{end}}
                >{{.Content}}</textarea>
            </label>
        </div>

        <footer class="flex row gap justify-end">
            <button
                hx-get="./trouble-reports/dialog-edit?cancel=true"
                hx-trigger="click"
                hx-target="#dialogEdit"
                hx-swap="outerHTML"
                type="button"
                class="secondary flex row gap"
            >
                <i class="bi bi-x-circle"></i>
                Schließen
            </button>

            <!-- Set button text based on ID value -->
            <button type="submit" class="flex row gap">
                <i class="bi bi-check-circle"></i>
                {{if gt .ID 0}} Aktualisieren {{else}} Erstellen {{end}}
            </button>
        </footer>
    </form>

    <script>
        document.querySelector("#dialogEdit").showModal();
    </script>
</dialog>
{{else}}
<span
    hx-get="./trouble-reports/data"
    hx-trigger="load"
    hx-target="#data"
    hx-swap="outerHTML"
    id="dialogEdit"></span>
{{end}}
