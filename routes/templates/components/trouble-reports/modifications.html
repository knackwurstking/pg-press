<div id="data" class="flex column gap">
    <span>
        <button
            hx-get="./trouble-reports/data"
            hx-trigger="click"
            hx-target="#data"
            hx-swap="outerHTML"
            class="contrast flex gap"
        >
            <i class="bi bi-arrow-left"></i>Zurück
        </button>
    </span>

    <div id="modifications-list" class="flex column gap">
        <h3>Änderungsverlauf</h3>

        {{$troubleReport := .TroubleReport}}
        {{$firstModified := .FirstModified}}
        {{$currentModified := $troubleReport.Mods.Current}}

        {{range $mod := .Mods}}

        <div
            {{if eq $currentModified.Time $mod.Time}}
            style="padding: var(--ui-spacing); border-color: var(--ui-primary)"
            {{else}}
            style="padding: var(--ui-spacing);"
            {{end}}

            class="border"
        >
            {{if eq $firstModified.Time $mod.Time }}
            <p>Erstellt von {{$mod.User.UserName}} am {{$mod.GetTimeString}}</p>
            {{else}}
            <p>Geändert von {{$mod.User.UserName}} am {{$mod.GetTimeString}}</p>
            {{end}}

            <div class="flex column gap">
                <strong>{{$mod.Data.Title}}</strong>
                <pre>{{$mod.Data.Content}}</pre>
            </div>

            {{if ne $currentModified.Time $mod.Time}}
            <div class="flex gap" style="margin-top: var(--ui-spacing); justify-content: flex-end;">
                <button
                    hx-post="./trouble-reports/modifications/{{$troubleReport.ID}}?time={{$mod.Time}}"
                    hx-trigger="click"
                    hx-target="#data"
                    hx-swap="outerHTML"
                    hx-confirm="Möchten Sie wirklich zu dieser Version zurückkehren?"
                    class="secondary flex gap"
                >
                    <i class="bi bi-arrow-counterclockwise"></i>
                    Zurücksetzen
                </button>
            </div>
            {{end}}
        </div>

        {{end}}
    </div>
</div>
