package templates

import (
	"github.com/knackwurstking/pg-press/models"
	"github.com/knackwurstking/pg-press/utils"
	"github.com/knackwurstking/ui"
)

templ NewToolDialog() {
	@ui.Dialog(ui.DialogProps{
		Method:           "POST",
		Href:             utils.UrlDialogs().EditTool(0),
		ID:               "tool-dialog",
		SubmitButtonText: "Erstellen",
	}) {
		{{ tool := &models.Tool{} }}
		@toolPositionAndPressSelection(tool.Position, tool.Press)
		@toolFormat(tool.Format.Width, tool.Format.Height)
		@toolType(tool.Type)
		@toolCode(tool.Code)
	}
}

templ EditToolDialog(tool *models.Tool) {
	@ui.Dialog(ui.DialogProps{
		Method:           "PUT",
		Href:             utils.UrlDialogs().EditTool(tool.ID),
		ID:               "tool-edit-dialog",
		SubmitButtonText: "Aktualisieren",
	}) {
		@toolPositionAndPressSelection(tool.Position, tool.Press)
		@toolFormat(tool.Format.Width, tool.Format.Height)
		@toolType(tool.Type)
		@toolCode(tool.Code)
	}
}

templ toolPositionAndPressSelection(inputPosition models.Position, inputPressSelection *models.PressNumber) {
	<div class="flex flex-row gap flex-wrap justify-between items-center">
		<div class="flex flex-col gap-0">
			<label for="position">Position</label>
			<select id="position" name="position" required>
				<option
					value=""
					if inputPosition == "" {
						selected
					}
				>
					Position ausw√§hlen
				</option>
				<option
					value={ models.PositionTop }
					if inputPosition == models.PositionTop {
						selected
					}
				>
					Oberteil
				</option>
				<option
					value={ models.PositionBottom }
					if inputPosition == models.PositionBottom {
						selected
					}
				>
					Unterteil
				</option>
				<option
					value={ models.PositionTopCassette }
					if inputPosition == models.PositionTopCassette {
						selected
					}
				>
					Kassette
				</option>
			</select>
		</div>
		<div class="flex flex-col gap-0 w-fit">
			<label for="pressSelection">Presse</label>
			<select id="pressSelection" name="press-selection">
				<option
					value=""
					if !models.IsValidPressNumber(inputPressSelection) {
						selected
					}
				>
					Nicht Eingebaut
				</option>
				<option
					value="0"
					if models.IsValidPressNumber(inputPressSelection) && *inputPressSelection == 0 {
						selected
					}
				>
					Presse 0
				</option>
				<option
					value="2"
					if models.IsValidPressNumber(inputPressSelection) && *inputPressSelection == 2 {
						selected
					}
				>
					Presse 2
				</option>
				<option
					value="3"
					if models.IsValidPressNumber(inputPressSelection) && *inputPressSelection == 3 {
						selected
					}
				>
					Presse 3
				</option>
				<option
					value="4"
					if models.IsValidPressNumber(inputPressSelection) && *inputPressSelection == 4 {
						selected
					}
				>
					Presse 4
				</option>
				<option
					value="5"
					if models.IsValidPressNumber(inputPressSelection) && *inputPressSelection == 5 {
						selected
					}
				>
					Presse 5
				</option>
			</select>
		</div>
	</div>
}

templ toolFormat(inputWidth int, inputHeight int) {
	<div class="flex flex-col gap-0">
		<label>Format</label>
		<div class="flex gap-sm">
			<input
				type="number"
				id="width"
				name="width"
				class="w-full"
				placeholder="z.B. 120"
				if inputWidth != 0 {
					value={ inputWidth }
				}
				required
			/>
			<span class="text-xl" style="margin: auto 0;">x</span>
			<input
				type="number"
				id="height"
				name="height"
				class="w-full"
				placeholder="z.B. 60"
				if inputHeight != 0 {
					value={ inputHeight }
				}
				required
			/>
		</div>
	</div>
}

templ toolType(inputType string) {
	<div class="flex flex-col gap-0">
		<label for="type">Typ</label>
		<input
			type="text"
			id="type"
			name="type"
			placeholder="z.B. MASS, FC, GTC"
			value={ inputType }
		/>
	</div>
}

templ toolCode(inputCode string) {
	<div class="flex flex-col gap-0">
		<label for="code">Code</label>
		<input
			type="text"
			id="code"
			name="code"
			placeholder="z.B. G01, G02, XXL01, 3573"
			value={ inputCode }
			required
		/>
	</div>
}
