package handler

import (
	"fmt"

	"github.com/labstack/echo/v4"

	"github.com/knackwurstking/pgpress/internal/constants"
	"github.com/knackwurstking/pgpress/internal/htmxhandler"
	"github.com/knackwurstking/pgpress/internal/utils"
)

type TroubleReports struct {
	*Base
}

func (h *TroubleReports) RegisterRoutes(e *echo.Echo) {
	path := "/trouble-reports"

	fmt.Println("Registering routes for trouble reports", h.ServerPathPrefix+path)
	e.GET(h.ServerPathPrefix+path, h.handleMainPage)

	htmxTroubleReports := htmxhandler.TroubleReports{Base: h.NewHTMX(path)}
	htmxTroubleReports.RegisterRoutes(e)
}

func (h *TroubleReports) handleMainPage(c echo.Context) error {
	return utils.HandleTemplate(c, nil,
		h.Templates,
		constants.TroubleReportsPageTemplates,
	)
}
