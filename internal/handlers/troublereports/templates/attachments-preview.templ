package templates

import (
	"fmt"

	"github.com/knackwurstking/pg-press/internal/components"
	"github.com/knackwurstking/pg-press/internal/shared"
	"github.com/knackwurstking/pg-press/internal/urlb"
)

templ AttachmentsPreview(attachments []*shared.Image) {
	if len(attachments) > 0 {
		<div class="attachments-preview-container">
			<div class="attachments-preview-label flex gap items-center select-none">
				<i class="bi bi-paperclip"></i>
				Bilder ({ len(attachments) })
			</div>
			<div class="attachments-preview-scroll flex gap">
				for _, attachment := range attachments {
					@attachmentPreviewItem(attachment)
				}
			</div>
		</div>
	}
}

templ attachmentPreviewItem(attachment *shared.Image) {
	<div
		class="attachment-preview-item flex flex-col gap items-center select-none ghost"
		onclick={ components.OpenImageViewer(
			urlb.TroubleReportsAttachment(0, attachment.Name),
		) }
		tabindex="0"
		role="button"
		aria-label={ fmt.Sprintf("Bild \"%s\" anzeigen", attachment.Name) }
	>
		<div class="attachment-preview-image">
			<img
				loading="lazy"
				src={ attachment.ServerPath() }
				alt={ fmt.Sprintf("Anhang \"%s\"", attachment.Name) }
				class="preview-thumbnail select-none"
			/>
		</div>
	</div>
}
